# Dockerfile for Plano - Multi-LLM router service
# Plano provides intelligent routing across multiple LLM providers
# https://github.com/katanemo/plano

FROM python:3.12-slim

WORKDIR /app

# Install uv for fast Python package management
RUN pip install --no-cache-dir uv

# Install planoai using uv
RUN uv tool install planoai

# Create directory for config
RUN mkdir -p /etc/plano

# Add uv tools to PATH
ENV PATH="/root/.local/bin:${PATH}"

# Expose Plano's default port
EXPOSE 8080

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=10s --retries=3 \
    CMD wget -qO- http://localhost:8080/health > /dev/null || exit 1

# Run Plano with mounted config
# Config file should be mounted at /etc/plano/config.yaml
CMD ["planoai", "up", "/etc/plano/config.yaml"]
