# Definition of Done: Phase 4 Priority Features Sprint

**Generated:** 2026-01-09
**Sprint Goal:** Deliver web-based configuration viewing, data management controls, and Gemini provider support

---

## Deliverable 1: Web Routing Configuration (Read-Only)

### Acceptance Criteria

**Backend Config API:**
- [ ] GET `/api/config` returns full configuration
- [ ] GET `/api/config/providers` returns provider list
- [ ] GET `/api/config/subagents` returns subagent mappings
- [ ] API keys replaced with `"***REDACTED***"` - NEVER exposed
- [ ] Integration test verifies no API keys in any response

**Frontend Types & Hooks:**
- [ ] TypeScript types match backend Config structs exactly
- [ ] `useConfig()`, `useProviders()`, `useSubagentConfig()` hooks work
- [ ] React Query cache configured with 60s stale time

**Frontend Display:**
- [ ] Routing page shows "Providers" section with name, format, base URL
- [ ] API key configured indicator shows (yes/no badge)
- [ ] "Subagent Mappings" section shows all mappings
- [ ] Enable/disable status displayed prominently
- [ ] Loading and error states handled gracefully

---

## Deliverable 2: Data Management Controls

### Acceptance Criteria

**Manual Refresh:**
- [ ] Refresh button on Requests page with RefreshCw icon
- [ ] Refresh button on Dashboard page
- [ ] Refresh button on Usage page
- [ ] Refresh button on Performance page
- [ ] Refresh button on Routing page
- [ ] All show spinning animation during refresh
- [ ] All disable during refresh
- [ ] Error toast on failure
- [ ] "Last updated: Xm ago" timestamp displayed

**Clear All Requests:**
- [ ] "Clear All Requests" button in Settings page
- [ ] Confirmation modal opens on click
- [ ] Warning message displayed
- [ ] Must type "DELETE" to enable confirm button
- [ ] Cancel closes modal without action
- [ ] Confirm calls DELETE `/api/requests`
- [ ] Success toast shown
- [ ] Request list and stats refresh after clear
- [ ] Empty state shown when no requests

**Auto-Refresh Settings:**
- [ ] Settings page has "Auto-Refresh" toggle
- [ ] Interval selector: 30s, 1m, 5m, 10m options
- [ ] Settings persist in localStorage across sessions
- [ ] Visual indicator (pulsing icon) when active
- [ ] Applies to all pages globally
- [ ] Default: OFF with 1m interval
- [ ] Changing interval updates immediately

---

## Deliverable 3: Gemini Provider Support

### Acceptance Criteria

**Configuration:**
- [ ] Gemini example in `config.yaml.example`
- [ ] Correct base URL: `https://generativelanguage.googleapis.com/v1beta/openai/`
- [ ] Subagent mapping example included
- [ ] Available models documented in config comments

**Verification:**
- [ ] Test request forwarded to Gemini API successfully
- [ ] Streaming responses work correctly
- [ ] Token usage captured in dashboard
- [ ] Error handling works (invalid key, rate limits)

**Documentation:**
- [ ] CLAUDE.md updated with Gemini setup instructions
- [ ] Troubleshooting guide for common issues

---

## General Definition of Done

For the sprint to be considered complete:

- [ ] All acceptance criteria above are met
- [ ] Code passes `just test` (all tests passing)
- [ ] Code passes `just check` (lint + typecheck)
- [ ] No security issues (API keys never exposed)
- [ ] Manual testing completed for all features
- [ ] Code reviewed for quality
- [ ] Documentation updated where behavior changed
