# Definition of Done: Tool Use Display

**Generated**: 2025-12-24-223724
**Plan**: PLAN-2025-12-24-223724.md
**Epic**: brandon-fryslie_claude-code-proxy-62s

---

## Acceptance Criteria

### Base ToolUse Component
- [ ] Component renders tool name with Wrench icon in gradient card (indigo/blue theme)
- [ ] Component displays tool call ID in monospace header
- [ ] Component shows parameter count badge
- [ ] Component has expand/collapse toggle for parameters (auto-collapse if >2 params)
- [ ] Component displays "Tool execution initiated" indicator with pulsing dot
- [ ] Component handles missing input gracefully (empty object)
- [ ] Component uses lucide-react icons: Wrench, ChevronDown, ChevronRight, Terminal, Zap
- [ ] Unit tests cover all UI states (collapsed, expanded, no params, many params)

### Parameter Rendering
- [ ] Short strings (<200 chars, no newlines) render inline with monospace font
- [ ] Large strings (>200 chars or multiline) show "Show/Hide large parameter" toggle
- [ ] Complex objects show "Show object (N properties)" collapsible details
- [ ] Expanded large parameters display in scrollable pre block (max-height: 256px)
- [ ] Parameter values use formatValue() and formatJSON() utilities
- [ ] Each parameter displays in gray card with key highlighted in indigo
- [ ] Parameter grid uses consistent spacing (space-y-3)
- [ ] Unit tests verify truncation, expansion, and object handling

### Copy-to-Clipboard
- [ ] Copy button appears in tool card header (Copy icon from lucide-react)
- [ ] Button copies `{ name, id, input }` as formatted JSON to clipboard
- [ ] Button shows checkmark icon for 2 seconds after successful copy
- [ ] Button handles copy errors gracefully (logs to console, no crash)
- [ ] Button has hover state with indigo accent
- [ ] Unit tests verify copy behavior (mock clipboard API)

### Edit Tool Special Handling
- [ ] Detects Edit tool by checking `name === 'Edit'`
- [ ] Renders CodeDiff component with old_string, new_string, file_path
- [ ] Shows "Code Changes" section header above diff
- [ ] Hides raw parameters when showing custom Edit view
- [ ] Falls back to raw parameters if old_string or new_string missing
- [ ] Unit tests verify Edit detection and CodeDiff integration

### Read Tool Special Handling
- [ ] Detects Read tool by checking `name === 'Read'`
- [ ] Shows "File Contents" section header
- [ ] Displays file_path in monospace with "Reading: " prefix
- [ ] Uses small text (text-xs) with gray color scheme
- [ ] Still shows other parameters if present (limit, offset)
- [ ] Unit tests verify Read detection and file path display

### TodoWrite Tool Special Handling
- [ ] Detects TodoWrite tool by checking `name === 'TodoWrite'`
- [ ] Shows "Task Management" section header
- [ ] Renders TodoList component with `input.todos` array
- [ ] Validates todos is an array before rendering
- [ ] Falls back to raw parameters if todos missing/invalid
- [ ] Hides raw parameters when showing TodoList
- [ ] Unit tests verify TodoWrite detection and TodoList integration

### TodoList Component
- [ ] Component accepts `todos` prop (array of todo objects)
- [ ] Each todo displays status badge (pending, in_progress, completed)
- [ ] Each todo shows content (imperative form)
- [ ] In-progress todos show activeForm if present
- [ ] Completed todos show checkmark icon
- [ ] Status badges use appropriate colors (gray, blue, green)
- [ ] Component handles empty array gracefully
- [ ] Unit tests verify all status types and edge cases

### MessageContent Integration
- [ ] MessageContent imports ToolUse component
- [ ] MessageContent renders ToolUse for content.type === 'tool_use'
- [ ] Passes name, id, input props from content block
- [ ] Handles missing name/id gracefully (defaults: 'Unknown Tool', 'unknown')
- [ ] Handles missing input gracefully (empty object)
- [ ] Integration tests verify tool_use rendering in full request view
- [ ] Tool calls appear correctly in Requests page detail panel

---

## Sprint Scope

### This Sprint Delivers
1. **ToolUse Component** - Full-featured tool call visualization
2. **TodoList Component** - Task list rendering for TodoWrite tools
3. **MessageContent Integration** - Tool calls visible in Requests page

### Deferred
- CodeDiff component (separate epic: code-viewer-highlighting)
- Tool call filtering/search
- Tool usage analytics
- Tool execution time metrics
